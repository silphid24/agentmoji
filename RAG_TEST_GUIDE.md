# 🤖 MOJI RAG 시스템 테스트 가이드

## 🚀 빠른 시작

### 1. 문서 준비
```bash
# 문서 폴더에 테스트 문서 추가
# 위치: data/documents/
# 지원 형식: .txt, .md, .docx
```

### 2. 문서 업로드 및 벡터화
```bash
# 문서를 벡터 DB에 업로드
python3 upload_docs.py
```

### 3. 서버 실행
```bash
# FastAPI 서버 시작
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 4. 웹챗에서 테스트
브라우저에서 접속: http://localhost:8000/static/webchat-test.html

## 💬 RAG 명령어

### 도움말 보기
```
/rag-help
```

### RAG 질문하기
```
/rag [질문]

예시:
/rag 프로젝트의 주요 목표는 무엇인가요?
/rag 사용된 기술 스택에 대해 설명해주세요
/rag 시스템 아키텍처는 어떻게 구성되어 있나요?
```

### RAG 통계 확인
```
/rag-stats
```

## 🎯 고급 기능

### 1. 질의 재작성 (Query Rewriting)
- 시스템이 자동으로 질문을 3가지 변형으로 재작성
- 동의어, 관련 개념을 고려한 검색
- 더 정확한 문서 검색 결과

### 2. 신뢰도 평가
- **HIGH**: 관련 문서가 충분하고 답변이 명확
- **MEDIUM**: 부분적 정보로 답변 생성
- **LOW**: 관련 정보 부족 또는 불확실

### 3. 출처 표시
- 답변에 사용된 문서 출처 표시
- 투명성과 검증 가능성 제공

## 📊 응답 형식

```
**답변**: [AI가 생성한 답변]

**신뢰도**: [HIGH/MEDIUM/LOW]
**근거**: [신뢰도 평가 이유]

**출처**:
- [사용된 문서 1]
- [사용된 문서 2]
```

## 🔧 설정 조정

### 검색 매개변수
- `k`: 검색할 문서 수 (기본값: 5)
- `score_threshold`: 최소 관련성 점수 (기본값: 0.7)

### 청크 설정
- `chunk_size`: 1000 문자
- `chunk_overlap`: 200 문자

## 📁 문서 관리

### 지원 형식
- `.txt`: 일반 텍스트
- `.md`: 마크다운
- `.docx`: MS Word (python-docx 필요)

### 문서 구조 권장사항
1. 명확한 제목과 섹션 구분
2. 구조화된 정보 (번호, 불릿 포인트)
3. 키워드를 포함한 설명적 내용

## 🧪 테스트 시나리오

### 1. 정확도 테스트
- 문서에 있는 구체적 정보 질문
- 여러 문서의 정보를 종합하는 질문
- 문서에 없는 정보 질문 (LOW 신뢰도 확인)

### 2. 질의 재작성 테스트
- 다양한 표현으로 같은 정보 질문
- 약어나 동의어 사용
- 맞춤법 오류 포함 질문

### 3. 신뢰도 테스트
- 명확한 답변이 있는 질문 (HIGH 예상)
- 부분적 정보만 있는 질문 (MEDIUM 예상)
- 관련 없는 질문 (LOW 예상)

## ⚠️ 주의사항

1. **첫 실행 시**: 임베딩 생성에 시간이 걸릴 수 있음
2. **API 키**: OpenAI API 키가 설정되어 있어야 함
3. **메모리**: 대량 문서 처리 시 메모리 사용량 주의

## 🔍 문제 해결

### "No relevant documents found" 오류
- 문서가 업로드되었는지 확인 (`/rag-stats`)
- 질문이 문서 내용과 관련있는지 확인
- score_threshold를 낮춰서 재시도

### 느린 응답
- 문서 수가 너무 많은 경우 청크 수 확인
- 네트워크 연결 상태 확인
- OpenAI API 응답 시간 확인